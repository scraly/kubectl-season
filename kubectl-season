#!/bin/bash

##################################################################################
# kubectl-season                                                                 #
#                                                                                #
# Welcome in Season plugin for kubectl Kubernetes CLI                            #
# which display randomly a seasonal emoji in the beginning of the resources name #
#                                                                                #
# Usage:                                                                         #
# ./kubectl-season <resource_type>                                               #
#                                                                                #
# Example:                                                                       #
# ./kubectl-season pod                                                           #
# NAME                        READY   STATUS    RESTARTS   AGE                   #
# ğŸƒ httpbin-c9cb9cbf6-r2gnc     1/1     Running   0          2d1h               #
# ğŸƒ my-nginx-75897978cd-f28j9   1/1     Running   0          2d20h              #
# ğŸƒ my-nginx-75897978cd-pt2dx   1/1     Running   0          43h                #
# ğŸƒ my-nginx-75897978cd-w2bcg   1/1     Running   0          42h                #
# ğŸƒ traefik-85854f965f-pb6j2    1/1     Running   1          137m               #
##################################################################################

# CONSTS
## Select emoji randomly
# FALL_EMOJIS=(ğŸ‚ ğŸŠ ğŸŒ° ğŸ¥® ğŸ¥§ â˜• ğŸƒ)
# RENTREE_EMOJIS=(ğŸ’ ğŸ–‹ï¸ ğŸšŒ ğŸ« ğŸ“š ğŸ‘¨â€ğŸ“ âœ‚ï¸ ğŸ“)
# HALLOWEEN_EMOJIS=(ğŸƒ ğŸ‘» ğŸ§Ÿ ğŸ§› ğŸ•· ğŸ§™ ğŸ’€ â˜  ğŸ˜ˆ)
# XMAS_EMOJIS=(ğŸ„ ğŸ ğŸ… ğŸ¦Œ ğŸª â˜ƒï¸ â„ï¸ ğŸŒŸ ğŸ¤¶)
# WINTER_EMOJIS=(ğŸ¥¶ ğŸ¥¨ ğŸ‚ ğŸŒ² â„ï¸ â˜ƒï¸ ğŸ¿ ğŸ§¤ â˜”)
# EASTER_EMOJIS=(ğŸ‡ ğŸ£ ğŸ« ğŸ¥š ğŸ”” ğŸ§º ğŸŒ¼ ğŸ)
# SUMMER_EMOJIS=(ğŸ˜ ğŸ„ ğŸŠ ğŸŒ´ ğŸ¹ â˜€ï¸ ğŸ‘• ğŸ¥µ)

NOW=`date +%m`

case $NOW in

  01|02|03)
    EMOJIS=(ğŸ¥¶ ğŸ¥¨ ğŸ‚ ğŸŒ² â„ï¸ â˜ƒï¸ ğŸ¿ ğŸ§¤ â˜”)
    ;;

  04|05)
    EMOJIS=(ğŸ‡ ğŸ£ ğŸ« ğŸ¥š ğŸ”” ğŸ§º ğŸŒ¼ ğŸ)
    ;;

  06|07|08)
    EMOJIS=(ğŸ˜ ğŸ„ ğŸŠ ğŸŒ´ ğŸ¹ â˜€ï¸ ğŸ‘• ğŸ¥µ)
    ;;

  09)
    EMOJIS=(ğŸ’ ğŸ–‹ï¸ ğŸšŒ ğŸ« ğŸ“š ğŸ‘¨â€ğŸ“ âœ‚ï¸ ğŸ“)
    ;;

  10)
    EMOJIS=(ğŸƒ ğŸ‘» ğŸ§Ÿ ğŸ§› ğŸ•· ğŸ§™ ğŸ’€ â˜  ğŸ˜ˆ)
    ;;

  11)
    EMOJIS=(ğŸ‚ ğŸŠ ğŸŒ° ğŸ¥® ğŸ¥§ â˜• ğŸƒ)
    ;;

  12)
    EMOJIS=(ğŸ„ ğŸ ğŸ… ğŸ¦Œ ğŸª â˜ƒï¸ â„ï¸ ğŸŒŸ ğŸ¤¶)
    ;;

esac

SELECTED_EMOJI=${EMOJIS[$(( ( RANDOM % ${#EMOJIS[@]} ) ))]};

## Usage
n=$'\n'
usage="Display seasonal emoji randomly just before resources name.${n}${n}Usage:${n}   kubectl season KIND${n}${n}Examples:${n}   kubectl season pod${n}   kubectl season pod,svc${n}   kubectl season deploy -A"

# MAIN
# Usage
if [[ "$1" == "" || "$1" == "-h" || "$1" == "--help" ]]
then
    echo "$usage" 
    exit 1
fi

# add an emoji at the beginning of the line except for blank line and line beginning by NAME
kubectl get "$@" | sed -E "/^(NAME|$)/ ! s/^/${SELECTED_EMOJI} /" | sed -E "s/(NAME)/   NAME/"